(()=>{"use strict";(()=>{let e="none",t=!1,n=!1,l=0,o=0,r=null;function s(){document.querySelectorAll(".blur-region").forEach(e=>{t?(e.addEventListener("mouseenter",()=>{e.style.backdropFilter="none",e.style.webkitBackdropFilter="none"}),e.addEventListener("mouseleave",()=>{e.style.backdropFilter="blur(5px)",e.style.webkitBackdropFilter="blur(5px)"})):(e.style.backdropFilter="blur(5px)",e.style.webkitBackdropFilter="blur(5px)")})}function i(){const e="screen-blur-extension",t=document.createElement("style");t.id="screen-blur-style",t.textContent=`\n        .${e} * {\n            filter: blur(5px) !important;\n        }\n        .${e} style, .${e} script {\n            filter: none !important;\n        }\n    `,document.head.appendChild(t),document.body.classList.add(e)}chrome.storage.local.get(["blurMode","hoverUnblur"],n=>{e=n.blurMode||"none",t=n.hoverUnblur||!1;const l=document.getElementById("screen-blur-extension");"screen"!==e||l||i()}),chrome.storage.onChanged.addListener(n=>{if(n.blurMode){const t=n.blurMode.newValue,l=n.blurMode.oldValue;if(e=t,"screen"===l){const e="screen-blur-extension";document.body.classList.remove(e);const t=document.getElementById("screen-blur-style");t&&t.remove()}"screen"===t&&i()}n.hoverUnblur&&(t=n.hoverUnblur.newValue,s())}),document.addEventListener("click",t=>{if("click"!==e)return;const n=t.target;if(n.classList.contains("blur-region"))return void n.remove();if(n.closest(".screen-blur-extension"))return;const l=n.getBoundingClientRect();!function(e,t,n,l){const o=document.createElement("div");o.className="blur-region",o.style.left=e+"px",o.style.top=t+"px",o.style.width=n+"px",o.style.height=l+"px",document.body.appendChild(o),s()}(l.left+window.scrollX,l.top+window.scrollY,l.width,l.height),t.stopPropagation()}),document.addEventListener("mousedown",t=>{if("draw"!==e)return;const s=t.target;s.classList.contains("blur-region")||s.closest(".screen-blur-extension")||(n=!0,l=t.clientX+window.scrollX,o=t.clientY+window.scrollY,r=document.createElement("div"),r.className="blur-region drawing",document.body.appendChild(r),r.style.left=l+"px",r.style.top=o+"px",r.style.width="0",r.style.height="0")}),document.addEventListener("mousemove",e=>{if(!n||!r)return;const t=e.clientX+window.scrollX,s=e.clientY+window.scrollY,i=Math.abs(t-l),c=Math.abs(s-o),d=Math.min(t,l),u=Math.min(s,o);r.style.width=i+"px",r.style.height=c+"px",r.style.left=d+"px",r.style.top=u+"px"}),document.addEventListener("mouseup",()=>{n&&r&&(n=!1,r.classList.remove("drawing"),r.addEventListener("click",function(){this.remove()}),r=null)})})()})();